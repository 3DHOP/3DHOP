<!DOCTYPE>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta content="charset=UTF-8"/>
<title>3DHOP - 3D Heritage Online Presenter</title>
<!--STYLESHEET-->
<link type="text/css" rel="stylesheet" href="stylesheet/3dhop.css"/>  
<!--SPIDERGL-->
<script type="text/javascript" src="js/spidergl.js"></script>
<!--JQUERY-->
<script type="text/javascript" src="js/jquery.js"></script>
<!--PRESENTER-->
<script type="text/javascript" src="js/presenter.js"></script>
<!--3D MODELS LOADING AND RENDERING-->
<script type="text/javascript" src="js/nexus.js"></script>
<script type="text/javascript" src="js/ply.js"></script>
<!--TRACKBALLS-->
<script type="text/javascript" src="js/trackball_sphere.js"></script>
<script type="text/javascript" src="js/trackball_turntable.js"></script>
<script type="text/javascript" src="js/trackball_turntable_pan.js"></script>
<script type="text/javascript" src="js/trackball_pantilt.js"></script>
<!--UTILITY-->
<script type="text/javascript" src="js/init.js"></script>
</head>
<body>
<div id="3dhop" class="tdhop" onmousedown="if (event.preventDefault) event.preventDefault()"><div id="tdhlg"></div>
 <div id="toolbar">
  <img id="home"         title="Home"                     src="skins/dark/home.png"   /><br/>
  <img id="zoomin"       title="Zoom In"                  src="skins/dark/zoomin.png" /><br/>
  <img id="zoomout"      title="Zoom Out"                 src="skins/dark/zoomout.png"/><br/>
  <img id="light_on"     title="Disable Light Control"    src="skins/dark/light_on.png" style="position:absolute; visibility:hidden;"/>
  <img id="light"        title="Enable Light Control"     src="skins/dark/light.png"/><br/>
  <img id="sections_on"  title="Disable Plane Sections"   src="skins/dark/sections_on.png" style="position:absolute; visibility:hidden;"/>
  <img id="sections"     title="Enable Plane Sections"    src="skins/dark/sections.png"/><br/>
  <img id="full_on"      title="Exit Full Screen"         src="skins/dark/full_on.png" style="position:absolute; visibility:hidden;"/>
  <img id="full"         title="Full Screen"              src="skins/dark/full.png"   />
 </div>
 <div id="sections-box" class="output-box"><span id="sections-output" class="output-text" onmousedown="event.stopPropagation()">
 <table class="sections-table">
  <tr>
    <td>Plane</td>
    <td>Position</td> 
    <td>Flip</td>
  </tr>
  <tr>
    <td>
      <img id="xplane_on" class="button_on" title="Disable X Axis Section" src="skins/dark/sectionX_on.png" onclick="xSwitch()"/>
      <img id="xplane"    class="button"    title="Enable X Axis Section"  src="skins/dark/sectionX.png"  onclick="xSwitch()"/><br/>
    </td>
    <td><input id="xplaneSlider" type="range"    title="Move X Axis Section Position"/></td> 
    <td><input id="xplaneFlip"   type="checkbox" title="Flip X Axis Section Direction"/></td>
  </tr>
  <tr>
    <td>
      <img id="yplane_on" class="button_on" title="Disable Y Axis Section" src="skins/dark/sectionY_on.png" onclick="ySwitch()"/>
      <img id="yplane"    class="button"    title="Enable Y Axis Section"  src="skins/dark/sectionY.png"  onclick="ySwitch()"/><br/>
    </td>
    <td><input id="yplaneSlider" type="range"    title="Move Y Axis Section Position"/></td> 
    <td><input id="yplaneFlip"   type="checkbox" title="Flip Y Axis Section Direction"/></td>
  </tr>
  <tr>
    <td>
      <img id="zplane_on" class="button_on" title="Disable Z Axis Section" src="skins/dark/sectionZ_on.png" onclick="zSwitch()"/>
      <img id="zplane"    class="button"    title="Enable Z Axis Section"  src="skins/dark/sectionZ.png"  onclick="zSwitch()"/><br/>
    </td>
    <td><input id="zplaneSlider" type="range"    title="Move Y Axis Section Position"/></td> 
    <td><input id="zplaneFlip"   type="checkbox" title="Flip Z Axis Section Direction"/></td>
  </tr>
  <tr>
 </table>
 <table class="sections-table">
  <tr>
    <td>Show planes<input id="showPlane" type="checkbox" title="Show Section Planes" checked /></td>
    <td style="text-align:right;">Show edges<input id="showBorder" type="checkbox" title="Show Section Edges"/></td> 
  </tr>
</table>
 </span></div>
 <canvas id="draw-canvas" style="background-image: url(skins/backgrounds/light.jpg)"/>
</div> 
</body>

<script type="text/javascript">
var presenter = null;

function setup3dhop() { 
	presenter = new Presenter("draw-canvas");

	presenter.setScene({
		meshes: {
			"Gargoyle" : { 
				url: "models/multires/gargo.nxs",
			},
			"Cube" : { url: "models/singleres/cube.ply" }
		},
		modelInstances : {
			"Gargo" : {
				mesh : "Gargoyle"
			},
			"Base" : {
				mesh : "Cube",
				transform : { matrix: SglMat4.mul(SglMat4.translation([0.0, -5.0, 0.0]), SglMat4.scaling([ 3.0, 0.2, 3.0])) }
			}
		},
		trackball: {
			type: TurntablePanTrackball,
			trackOptions: {
				startPhi      : 0.0,
				startTheta    : 0.0,
				startDistance : 1.5,
				startPanX     : 0.0,
				startPanY     : 0.0,
				startPanZ     : 0.0,
				minMaxPhi     : [-180, 180],
				minMaxTheta   : [-10.0, 50.0],
				minMaxDist    : [0.5, 3.0],
				minMaxPanX    : [-0.5, 0.5],
				minMaxPanY    : [-0.6, 0.6],
				minMaxPanZ    : [-0.3, 0.3],
			}
		},
		space: {
			centerMode: "scene",
			radiusMode: "scene",
		}
	});
}

function actionsToolbar(action) {
	if(action=='home') presenter.resetTrackball(); 
	else if(action=='zoomin') presenter.zoomIn();
	else if(action=='zoomout') presenter.zoomOut(); 
	else if(action=='light' || action=='light_on') { presenter.enableLightTrackball(!presenter.isLightTrackballEnabled()); lightSwitch(); } 
	else if(action=='sections') { showSectionTool(true); } 
	else if(action=='sections_on') { showSectionTool(false); } 
	else if(action=='full' || action=='full_on') fullscreenSwitch(); 
}

$(document).ready(function(){
	init3dhop();

	setup3dhop();

	moveSectionsbox(-1,0);
});
</script>

</html>
